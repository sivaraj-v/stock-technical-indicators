"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ATR_1=require("./ATR"),index_1=require("./index"),IStudy_1=require("./schema/IStudy"),Supertrend=function(){function e(){}return e.prototype.doAlgorithm=function(e,r){for(var n=new index_1.Indicator(new ATR_1.ATR).calculate(e,r),t=0;t<n.length;t++){var u=n[t];if(n[t].Supertrend=new IStudy_1.ISupertrend,u){var d=(u[2]+u[3])/2,p=r.multiplier*u.ATR.Value,i=d-p,S=d+p;t&&(n[t-1]&&n[t-1][4]&&n[t-1][4]>n[t-1].Supertrend.Up&&n[t-1].Supertrend.Up>i&&(i=n[t-1].Supertrend.Up),n[t-1]&&n[t-1][4]&&n[t-1][4]<n[t-1].Supertrend.Down&&n[t-1].Supertrend.Down<S&&(S=n[t-1].Supertrend.Down)),u.Supertrend.Direction=1,t&&(u.Supertrend.Direction=n[t-1].Supertrend.Direction,u[4]>n[t-1].Supertrend.Down?u.Supertrend.Direction=1:u[4]<n[t-1].Supertrend.Up&&(u.Supertrend.Direction=-1)),u.Supertrend.Up=i,u.Supertrend.Down=S,u.Supertrend.ActiveTrend=u.Supertrend.Direction>0?i:S}}return n},e}();exports.Supertrend=Supertrend;